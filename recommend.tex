\chapter{推薦システム}
\label{chap:recommend}
本章では推薦システムについて述べる。

\newpage
\section{概要}
ユーザーのコンテキストを受け取り、過去の情報と比べることによって
ユーザーの入力する可能性が高い単語を推薦するシステム。

\section{取得コンテキスト}
\label{sec:getcontext}
入力が開始されてから終了まで変わらないコンテキスト何度も取得すると
システムに負荷がかかるため、変わるものとそうでないものに分類した。
入力が開始してから変化しないコンテキストを静的コンテキスト。
入力が開始してから変化する可能性があるコンテキストを動的コンテキストとした。
コンテキストにはユーザーが設定するものと、
Riveシステムが自動的に取得するものがある。

\subsection{静的コンテキスト}
\label{staticcontext}
以下静的コンテキストとして利用しているものを述べる。

\subsubsection{アクテビティー}
\label{activity}
アクテビティーとは入力する対象のことである。
androidOSにおいてはメールクライアントであったり、
WEBブラウザアプリなどである。
アクテビティーをコンテキストに含めることにより、
サービスごとに入力されやすい単語を推薦されやすくなる。

\subsubsection{性別}
性別をコンテキストに含めることにより、
同じ性別の人が使っている単語を推薦されやすくなる。
要素はユーザーが以下から選択する。
\begin{itemize}
  \item 男性
  \item 女性
  \item その他
\end{itemize}

\subsubsection{年齢}
年齢をコンテキストに含めることにより、
同じ年齢の人が使っている単語を推薦されやすくなる。

\subsubsection{キャラクター}
キャラクターをコンテキストに含めることにより、
簡易なユーザークラスタリングをし、同じクラスタの人が使っている
単語を推薦されやすくなる。
要素はユーザーが以下から選択する。
\begin{itemize}
  \item ヲタク
  \item JK
  \item 熱血
  \item 冷静
  \item おねぇ
  \item 一般人
\end{itemize}

\subsubsection{Gmailアカウント}
アカウントをコンテキストに含めることにより、
ユーザーごとのパーソナライズされた単語を推薦されやすくなる。
またこのコンテキストは極めてプライバシー性が高いため、
デフォルトの設定では送信しないようになっている。

\subsection{動的コンテキスト}
\label{dynamiccontext}
以下利用している動的コンテキストについて述べる。

\subsubsection{時間}
時間をコンテキストに含めることにより、
時間ごとに入力されやすい単語を推薦されやすくする。

\subsubsection{日付}
日付をコンテキストに含めることにより、
日付ごとに入力されやすい単語を推薦されやすくする。

\subsubsection{位置情報}
位置情報をコンテキストに含めることにより、
場所ごとに入力されやすい単語を推薦されやすくする。

\subsubsection{加速度}
加速度をコンテキストに含めることにより、
加速度ごとに入力されやすい単語を推薦されやすくする。

\subsubsection{現在の入力}
現在未変換状態の文字が何であるかをコンテキストに含めることにより、
どのような単語が求められているかを推測し推薦する。

\subsubsection{IMEを起動してからの全ての入力}
IMEを起動してからの全ての入力をコンテキストに含めることにより、
入力単語と同じ文章内で使われやすい単語を推薦されやすくなる。

\subsubsection{入力の状態}
IMEを起動したタイミングなのか、
文字を入力中なのか、
変換または入力を確定したタイミングなのかという
三つの状態のどの状態であるかを取得する。
入力の状態をコンテキストに含めることにより、
最初に入力されやすい単語や、終わりに入力されやすい単語などを
推薦されやすくなる。

\section{Jubatus}
\label{sec:jubatus}

\subsection{概要}
Jubatus\cite{jubatus}とは株式会社Preferred Infrastructureと
NTTソフトウェアイノベーションセンタが共同開発した、
オンライン機械学習向け分散処理フレームワークである。
本システムを使用することで推薦単語の候補計算をしている。
JubatusをRive日本語入力のシステムに組み込んだ理由は、
高速かつスケーラビリティに優れていたためである。
Riveではコンテキストを常に計算するため高速な処理が必要となり、
採用した。

\subsection{アルゴリズム}
取得した単語一つ一つがベクトルとなるようなn次元ベクトルを作っている。
そのn次元上で取得したコンテキストから新たなベクトルを作り、
近いものから順にスコア付し、候補単語として返すようになっている。
機械学習アルゴリズムにはAROW\cite{AROW}を使っている。

\section{推薦例}

